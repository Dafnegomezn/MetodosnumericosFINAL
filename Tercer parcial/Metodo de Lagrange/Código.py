from sympy import *
import matplotlib.pyplot as plt
import numpy as np

x = [67,52,56,66,65,80]
y = [481,292,357,396,345,469]

pL = ''
for k in range(len(y)):
    pL += str(y[k]) + '*'
    Lxk = 1
    for i in range(len(x)):
        if (i == k):
            continue
        pL += '(x -%f)*'%(x[i])
        Lxk *= (x[k]-x[i])
    pL = pL[:-1]
    pL += '/%f+'%(Lxk)
pL = pL[:-1]
print (pL)
expr = sympify(pL)
print(expand(expr))
plt.plot(x,y,'go')

x2 = np.linspace(52,80,100)
x = symbols('x')
y2 = [expr.subs(x,xi)for xi in x2]
plt.plot(x2,y2)
plt.grid()

481*(x -52.000000)*(x -56.000000)*(x -66.000000)*(x -65.000000)*(x -80.000000)/-4290.000000+292*
(x -67.000000)*(x -56.000000)*(x -66.000000)*(x -65.000000)*(x -80.000000)/-305760.000000+357*(x -67.000000)*
(x -52.000000)*(x -66.000000)*(x -65.000000)*(x -80.000000)/95040.000000+396*(x -67.000000)*(x -52.000000)*
(x -56.000000)*(x -65.000000)*(x -80.000000)/1960.000000+345*(x -67.000000)*(x -52.000000)*(x -56.000000)*
(x -66.000000)*(x -80.000000)/-3510.000000+469*(x -67.000000)*(x -52.000000)*(x -56.000000)*(x -66.000000)*
(x -65.000000)/1834560.000000-0.00531403120688833*x**5 + 1.66604526425954*x**4 - 207.626186611006*x**3 + 
12860.9406658817*x**2 - 396081.587455399*x + 4853386.71428572
